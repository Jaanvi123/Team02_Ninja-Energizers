{
	"info": {
		"_postman_id": "46697806-02a04270-13d1-4536-b895-26c5ea18b4dd",
		"name": "Team2_Ninja-Energizers-Dietician API-AutomationLatest",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Login",
			"item": [
				{
					"name": "SuccessfulMessages",
					"item": [
						{
							"name": "userLogin",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "5976740c-097f-458d-bf6f-db6618c57fd8",
										"exec": [
											"if(pm.variables.get(\"statusCode\")===200){\r",
											"    var jsonData = pm.response.json();\r",
											"pm.environment.set(\"authToken\",jsonData.token);\r",
											"}\r",
											"\r",
											"\r",
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"id": "06cdcb43-5f2f-4de6-ba17-708d309e94d2",
										"exec": [
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"id": "46697806-29da9107-b0e5-48e8-a590-3d195b7182e8",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\r\n  \"userLoginEmail\": \"{{user_LoginEmail}}\",\r\n  \"password\": \"{{user_password}}\"\r\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseURL}}{{endpoint}}",
									"host": [
										"{{baseURL}}{{endpoint}}"
									]
								}
							},
							"response": []
						}
					],
					"id": "46697806-65163e5d-0e68-45fb-acc5-7a426428043f"
				},
				{
					"name": "ErrorMessages",
					"item": [],
					"id": "46697806-87123fa2-8720-4b39-81c4-f521b31a3539"
				},
				{
					"name": "test",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "e86423dc-0cbc-4a8f-8b73-87f046db0f04",
								"exec": [
									"let data = pm.iterationData.toObject();\r",
									"\r",
									"if (data.name !== \"userLogin\") return;\r",
									"\r",
									"console.log(\"Data keys:\", Object.keys(data));\r",
									"console.log(\"expectedStatusCode:\", data.expectedStatusCode);\r",
									"console.log(\"expectedContentType:\", data.expectedContentType);\r",
									"\r",
									"console.log(\"🟡 Raw expectedStatusCode:\", data.expectedStatusCode);\r",
									"console.log(\"🟡 Type of expectedStatusCode:\", typeof data.expectedStatusCode);\r",
									"console.log(\"🟡 Converted Number(data.expectedStatusCode):\", Number(data.expectedStatusCode));\r",
									"\r",
									"// Logging test case info\r",
									"const testCaseId = data.testCaseId || \"Unknown_TC\";\r",
									"const scenarioName = data.scenarioName || \"Unknown_Scenario\";\r",
									"const scenarioType = data.scenarioType || \"Unknown_ScenarioType\";\r",
									"const method = pm.request.method;\r",
									"\r",
									"console.log(\"🔍 Full Response Object:\", pm.response);\r",
									"console.log(\"✅ pm.response.code (type):\", typeof pm.response.code);\r",
									"console.log(\"✅ pm.response.code (value):\", pm.response.code);\r",
									"\r",
									"// Validate status code presence and type\r",
									"if (typeof data.expectedStatusCode === \"undefined\") {\r",
									"    throw new Error(\"expectedStatusCode is missing in iteration data.\");\r",
									"}\r",
									"if (isNaN(data.expectedStatusCode)) {\r",
									"    throw new Error(`expectedStatusCode is not a number: ${data.expectedStatusCode}`);\r",
									"}\r",
									"\r",
									"const expectedStatusCode = Number(data.expectedStatusCode);\r",
									"const expectedContentType = data.expectedContentType || \"\";\r",
									"\r",
									"function logTestResult(testName, passed) {\r",
									"    console.log(`TC_ID: ${testCaseId}, Scenario: ${scenarioName}, Type: ${scenarioType}, Method: ${method}, Test: ${testName}, Result: ${passed ? \"PASS\" : \"FAIL\"}`);\r",
									"}\r",
									"\r",
									"function runTest(testName, testFunc) {\r",
									"    try {\r",
									"        pm.test(testName, testFunc);\r",
									"        logTestResult(testName, true);\r",
									"    } catch (err) {\r",
									"        logTestResult(testName, false);\r",
									"        throw err;\r",
									"    }\r",
									"}\r",
									"\r",
									"console.log(\"✅ pm.response.code:\", pm.response.code);\r",
									"console.log(\"✅ expectedStatusCode:\", expectedStatusCode);\r",
									"\r",
									"// ---- TESTS ----\r",
									"runTest(\"Status Code Validation\", () => {\r",
									"    pm.expect(pm.response.code).to.eql(expectedStatusCode);\r",
									"});\r",
									"\r",
									"runTest(\"Content-type Validation\", () => {\r",
									"    const contentType = pm.response.headers.get(\"Content-Type\") || \"\";\r",
									"    pm.expect(contentType.toLowerCase()).to.include(expectedContentType.toLowerCase());\r",
									"});\r",
									"\r",
									"runTest(\"Token Validation\", () => {\r",
									"    const jsonData = pm.response.json();\r",
									"    pm.expect(jsonData.token).to.be.a(\"string\").and.not.empty;\r",
									"});\r",
									"\r",
									"runTest(\"Valid JSON Response Validations\", () => {\r",
									"    pm.expect(() => pm.response.json()).not.to.throw();\r",
									"});\r",
									"\r",
									"runTest(\"Validate role as Admin- ROLE_ADMIN\", () => {\r",
									"    const jsonData = pm.response.json();\r",
									"    pm.expect(jsonData).to.have.property(\"roles\").that.is.an(\"array\").that.includes(\"ROLE_ADMIN\");\r",
									"});\r",
									"\r",
									"runTest(\"UserId Validation\", () => {\r",
									"    const jsonData = pm.response.json();\r",
									"    pm.expect(jsonData).to.have.property(\"userId\").that.is.a(\"number\");\r",
									"});\r",
									"\r",
									"runTest(\"Token Type Validation\", () => {\r",
									"    const jsonData = pm.response.json();\r",
									"    pm.expect(jsonData.type).to.include(\"Bearer\");\r",
									"});\r",
									"\r",
									"runTest(\"Email Id Validation\", () => {\r",
									"    const jsonData = pm.response.json();\r",
									"    pm.expect(jsonData).to.have.property(\"loginUserEmail\").that.equals(data.user_LoginEmail);\r",
									"});\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"id": "46697806-d9fb70e4-3e06-4b24-91be-cd21ec0f2bb8",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"userLoginEmail\": \"{{user_LoginEmail}}\",\r\n  \"password\": \"{{user_password}}\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}{{endpoint}}",
							"host": [
								"{{baseUrl}}{{endpoint}}"
							]
						}
					},
					"response": []
				}
			],
			"id": "46697806-efec67ac-7025-428b-9a80-239efe60c050"
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"id": "17acdd92-53e3-46ab-a223-bb3310cc29a6",
				"type": "text/javascript",
				"packages": {},
				"exec": [
					"// Fetch current row of test data\r",
					"const requestName = pm.info.requestName;\r",
					"const allData = pm.iterationData.toObject();\r",
					"\r",
					"// Optional: Only run this for specific request\r",
					"if (requestName !== \"userLogin\") return;\r",
					"\r",
					"// Find matching request group by name\r",
					"const group = allData.requests?.find(r => r.name === requestName);\r",
					"\r",
					"if (!group || !Array.isArray(group.data) || group.data.length === 0) {\r",
					"    console.error(`No data found for request: ${requestName}`);\r",
					"    return;\r",
					"}\r",
					"\r",
					"// Track current test case index\r",
					"const index = pm.info.iteration;\r",
					"\r",
					"// Get the corresponding test case data\r",
					"const testCase = group.data[index];\r",
					"if (!testCase) {\r",
					"    console.warn(`No testCase found for iteration ${index}`);\r",
					"    return;\r",
					"}\r",
					"\r",
					"// Set variables for use in the request body, headers, etc.\r",
					"Object.entries(testCase).forEach(([key, value]) => {\r",
					"    pm.variables.set(key, value);\r",
					"});\r",
					"\r",
					"// Optional Logging\r",
					"console.log(`🧪 Running TestCase: ${testCase.testCaseId} - ${testCase.scenarioName}`);\r",
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"id": "de748408-eaf3-4fe8-8e57-a5f358c0a7aa",
				"type": "text/javascript",
				"packages": {},
				"exec": [
					"\r",
					"pm.test(\"Status code is expected\", function () {\r",
					"    pm.response.to.have.status(pm.variables.get(\"expectedStatusCode\"));\r",
					"});\r",
					"\r",
					"pm.test(\"Status line is correct\", function () {\r",
					"  pm.expect(pm.response.status).to.eql(pm.variables.get(\"expectedStatusLine\")); \r",
					"});\r",
					"\r",
					"pm.test(\"Content-Type is correct\", function () {\r",
					"    pm.response.to.have.header(\"Content-Type\", pm.variables.get(\"expectedContentType\"));\r",
					"});\r",
					"pm.test(\"Response time is less than 1000ms\", function () {\r",
					"    pm.expect(pm.response.responseTime).to.be.below(1000);\r",
					"});\r",
					"\r",
					"\r",
					""
				]
			}
		}
	]
}